# edata
api wrapper for public spending portal


###get_transactions()

```r

get_transactions(payer, recipt, start, end, region, save)

```

Функція, котра повертає dataframe із транзакціями за заданими параметрами:

* payer - ЄДРПОУ платника, не може містити менше 8 знаків;  
* recepient - ЄДРПОУ отримувача, не може містити менше 8 знаків;   
* start - дата у форматі yyyy-mm-dd;   
* end - дата у форматі yyyy-mm-dd; 
* region - код регіону; 
* save - чи зберегти таблицю в csv файл замість повертати у вигляді dataframe; за замовчуванням, має значення FALSE.

Обов’язкові параметри - payer або recipt, решта параметрів працює як фільтри.

Приклад використання:

```r

transactions <- get_transactions(payer = '20077720')

```
Цей запит поверне dataframe зо всіма доступними транзакціями, в яких платником виступає НАК Нафтогаз України.

```r

get_transactions(payer = '20077720', save = TRUE)

```

Цей запит створить у поточній working directory теку із назвою data, а в ній теку із назвою transactions і запише туди csv файл із даними. Назва файлу буде конструюватись із параметрів запиту. В даному випадку це буде щось на зразок '20077720---.csv'. Якщо у запиті будуть інші параметри (ЄДРПОУ отримувача, дати), вони додадуться у назву файлу.

Ви можете в одному запиті зазначати одразу кілька платників або отримувачів. 

```r

transactions <- get_transactions(payer = '20077720,30019801')

```

Цей запит поверне dataframe із транзакціями, в яких платником є НАК Нафтогаз України або ПАТ Укртрангаз.

###get_regions()

```r

regions <- get_regions()

```

Функція, яка повертає dataframe із назвами регіонів та їх числовими кодами. Ці коди можна згодом використати у функції ```get_transactions()``` для фільтрування транзакцій. Ця функція не має параметрів.

###get_organizations()

```r

organizations <- get_organizations()

```

Функція, яка повертає dataframe із переліком всіх організацій, транзакції котрих містяться у базі Є-data. У цій таблиці зокрема містяться ЄДРПОУ організацій, а також дати реєстрації та статистика оприлюднення даних на порталі. 

API Є-data віддає перелік організацій у заархівованому файлі, тому ця функція завантажить архів e теку data (якщо її нема у поточній working directory, її буде створено), розпакує архів та прочитає файл у ньому.

Ця функція не має параметрів.

###top_transactions()

```r

top_transactions <- top_transactions(region = 26)

```

Функція, яка повертає 100 найбільших транзакцій для заданого регіону. Якщо регіон не задано, API використовує значення за замовчуванням (28 і 26 - це наче мають бути всі області та Київ).

---

[Опис API Є-дата](https://confluence.spending.gov.ua/pages/viewpage.action?pageId=5800614&src=contextnavpagetreemode)